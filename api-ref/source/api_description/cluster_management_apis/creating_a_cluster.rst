:original_name: dws_02_0020.html

.. _dws_02_0020:

Creating a Cluster
==================

Function
--------

This API is used to create clusters.

The cluster must run in a VPC. Before creating a cluster, you need to create a VPC and obtain the VPC and subnet IDs.

This API is an asynchronous API. It takes 10 to 15 minutes to create a cluster.

.. note::

   Currently, only standard data warehouses can be created via this API.

URI
---

-  URI format

   .. code-block:: text

      POST /v1.0/{project_id}/clusters

-  Parameter description

   .. table:: **Table 1** URI parameters

      +------------+-----------+--------+------------------------------------------------------------------------------------------------------+
      | Parameter  | Mandatory | Type   | Description                                                                                          |
      +============+===========+========+======================================================================================================+
      | project_id | Yes       | String | Project ID. For details about how to obtain the ID, see :ref:`Obtaining a Project ID <dws_02_0011>`. |
      +------------+-----------+--------+------------------------------------------------------------------------------------------------------+

Request Message
---------------

-  Request example

   .. code-block:: text

      POST /v1.0/89cd04f168b84af6be287f71730fdb4b/clusters

      {
      "cluster": {
              "node_type":  "dws.d1.xlarge.ultrahigh",
              "number_of_node": 3,
              "subnet_id": "374eca02-cfc4-4de7-8ab5-dbebf7d9a720",
              "security_group_id": "dc3ec145-9029-4b39-b5a3-ace5a01f772b",
              "vpc_id": "85b20d7e-9eb7-4b2a-98f3-3c8843ea3574",
              "availability_zone": "eu-de-01",
              "port": 8000,
              "name": "dws-1",
              "user_name": "dbadmin",
              "user_pwd": "Password!",
              "public_ip": {
                  "public_bind_type": "auto_assign",
                  "eip_id": ""
              },
              "enterprise_project_id":"aca4e50a-266f-4786-827c-f8d6cc3fbada"     }
      }

-  Parameter description

   .. table:: **Table 2** Request parameters

      +-----------+-----------+------------------------------------------------------------------------------------------------------------------+----------------+
      | Parameter | Mandatory | Type                                                                                                             | Description    |
      +===========+===========+==================================================================================================================+================+
      | cluster   | Yes       | :ref:`CreateClusterInfo <en-us_topic_0000001179166012__en-us_topic_0000001098816618_table15931340184218>` object | Cluster object |
      +-----------+-----------+------------------------------------------------------------------------------------------------------------------+----------------+

   .. _en-us_topic_0000001179166012__en-us_topic_0000001098816618_table15931340184218:

   .. table:: **Table 3** CreateClusterInfo

      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter             | Mandatory       | Type                                                                                                  | Description                                                                                                                                                                               |
      +=======================+=================+=======================================================================================================+===========================================================================================================================================================================================+
      | node_type             | Yes             | String                                                                                                | Node type.                                                                                                                                                                                |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | number_of_node        | Yes             | Integer                                                                                               | Number of cluster nodes. For a cluster, the value ranges from 3 to 256. For a hybrid data warehouse (standalone), the value is 1.                                                         |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | subnet_id             | Yes             | String                                                                                                | Subnet ID, which is used for configuring cluster network.                                                                                                                                 |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | security_group_id     | Yes             | String                                                                                                | ID of a security group, which is used for configuring cluster network.                                                                                                                    |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | vpc_id                | Yes             | String                                                                                                | VPC ID, which is used for configuring cluster network.                                                                                                                                    |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | availability_zone     | No              | String                                                                                                | AZ of a cluster.                                                                                                                                                                          |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | port                  | No              | Integer                                                                                               | Service port of a cluster. The value ranges from 8000 to 30000. The default value is **8000**.                                                                                            |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | name                  | Yes             | String                                                                                                | Cluster name, which must be unique. The cluster name must contain 4 to 64 characters, which must start with a letter. Only letters, digits, hyphens (-), and underscores (_) are allowed. |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | user_name             | Yes             | String                                                                                                | Administrator username for logging in to a GaussDB(DWS) cluster. The username must:                                                                                                       |
      |                       |                 |                                                                                                       |                                                                                                                                                                                           |
      |                       |                 |                                                                                                       | -  Consist of lowercase letters, digits, or underscores.                                                                                                                                  |
      |                       |                 |                                                                                                       | -  Start with a lowercase letter or an underscore.                                                                                                                                        |
      |                       |                 |                                                                                                       | -  Contain 1 to 63 characters.                                                                                                                                                            |
      |                       |                 |                                                                                                       | -  Cannot be a keyword of the GaussDB(DWS) database.                                                                                                                                      |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | user_pwd              | Yes             | String                                                                                                | Administrator password for logging in to a GaussDB(DWS) cluster                                                                                                                           |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | public_ip             | No              | :ref:`PublicIp <en-us_topic_0000001179166012__en-us_topic_0000001098816618_request_public_ip>` object | Public IP address. If the parameter is not specified, public connection is not used by default.                                                                                           |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | number_of_cn          | No              | Integer                                                                                               | Number of deployed CNs. The value ranges from 2 to the number of cluster nodes minus 1. The maximum value is **20** and the default value is **3**.                                       |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | enterprise_project_id | No              | String                                                                                                | Enterprise project. The default enterprise project ID is **0**.                                                                                                                           |
      +-----------------------+-----------------+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. _en-us_topic_0000001179166012__en-us_topic_0000001098816618_request_public_ip:

   .. table:: **Table 4** PublicIp

      +------------------+-----------------+-----------------+----------------------------------------------------------------+
      | Parameter        | Mandatory       | Type            | Description                                                    |
      +==================+=================+=================+================================================================+
      | public_bind_type | Yes             | String          | Binding type of an EIP. The value can be one of the following: |
      |                  |                 |                 |                                                                |
      |                  |                 |                 | -  **auto_assign**                                             |
      |                  |                 |                 | -  **not_use**                                                 |
      |                  |                 |                 | -  **bind_existing**                                           |
      +------------------+-----------------+-----------------+----------------------------------------------------------------+
      | eip_id           | No              | String          | EIP ID                                                         |
      +------------------+-----------------+-----------------+----------------------------------------------------------------+

Response Message
----------------

-  Example response

   .. code-block::

      {
          "cluster": {
              "id": "7d85f602-a948-4a30-afd4-e84f47471c15"
           }
      }

-  Parameter description

   .. table:: **Table 5** Response parameters

      +-----------+-----------------------------------------------------------------------------------------------------+----------------+
      | Parameter | Type                                                                                                | Description    |
      +===========+=====================================================================================================+================+
      | cluster   | :ref:`Cluster <en-us_topic_0000001179166012__en-us_topic_0000001098816618_response_cluster>` object | Cluster object |
      +-----------+-----------------------------------------------------------------------------------------------------+----------------+

   .. _en-us_topic_0000001179166012__en-us_topic_0000001098816618_response_cluster:

   .. table:: **Table 6** Cluster

      ========= ====== ===========
      Parameter Type   Description
      ========= ====== ===========
      id        String Cluster ID
      ========= ====== ===========

Status Code
-----------

-  Normal

   200

-  Exception

   .. table:: **Table 7** Returned values

      ========================= ===========================
      Returned Value            Description
      ========================= ===========================
      400 Bad Request           Request error.
      401 Unauthorized          Authorization failed.
      403 Forbidden             No operation permission.
      404 Not Found             No resources found.
      500 Internal Server Error Internal service error.
      503 Service Unavailable   The service is unavailable.
      ========================= ===========================
