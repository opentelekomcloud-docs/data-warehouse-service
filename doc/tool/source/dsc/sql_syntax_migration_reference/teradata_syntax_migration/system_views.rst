:original_name: dws_16_0102.html

.. _dws_16_0102:

System Views
============

**dbc.columnsV** and **dbc.IndicesV**
-------------------------------------

+------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------+
| Input                                                                                                                                                            | Output                                                                                                                                       |
+==================================================================================================================================================================+==============================================================================================================================================+
| .. code-block::                                                                                                                                                  | .. code-block::                                                                                                                              |
|                                                                                                                                                                  |                                                                                                                                              |
|    SELECT A.ColumnName                                                                            AS V_COLS                                                      |    DECLARE lv_mig_V_COLS   TEXT;                                                                                                             |
|          ,A.columnname  || ' ' ||CASE WHEN columnType in ('CF','CV')                                                                                             |              lv_mig_V_ColT        TEXT;                                                                                                      |
|                                            THEN CASE WHEN columnType='CV' THEN 'VAR' ELSE ''                                                                     |              lv_mig_V_PICol       TEXT;                                                                                                      |
|                  END||'CHAR('||TRIM(columnlength (INT))||                                                                                                        |    BEGIN                                                                                                                                     |
|                      ') CHARACTER SET LATIN'||                                                                                                                   |    SELECT STRING_AGG(A.ColumnName, ',')                                                                                                      |
|                        CASE WHEN UpperCaseFlag='N'                                                                                                               |          , STRING_AGG(A.columnname  || ' ' ||CASE WHEN columnType in ('CF','CV')                                                             |
|                           THEN ' NOT' ELSE ''                                                                                                                    |                                            THEN CASE WHEN columnType='CV' THEN 'VAR' ELSE ''                                                 |
|                        END || ' CASESPECIFIC'                                                                                                                    |                  END||'CHAR('||TRIM(mig_td_ext.mig_fn_castasint(columnlength))||                                                             |
|                                       WHEN columnType='DA' THEN 'DATE'                                                                                           |                      ') /*CHARACTER SET LATIN*/'||                                                                                           |
|                                       WHEN columnType='TS' THEN 'TIMESTAMP(' || TRIM(DecimalFractionalDigits)||')'                                               |                        CASE WHEN UpperCaseFlag='N'                                                                                           |
|                                       WHEN columnType='AT' THEN 'TIME('|| TRIM(DecimalFractionalDigits)||')'                                                     |                           THEN ' NOT' ELSE ''                                                                                                |
|                                       WHEN columnType='I' THEN 'INTEGER'                                                                                         |                        END || ' /*CASESPECIFIC*/'                                                                                            |
|                                       WHEN columnType='I1' THEN 'BYTEINT'                                                                                        |                                       WHEN columnType='DA' THEN 'DATE'                                                                       |
|                                       WHEN columnType='I2' THEN 'SMALLINT'                                                                                       |                                       WHEN columnType='TS' THEN 'TIMESTAMP(' || TRIM(DecimalFractionalDigits)||')'                           |
|                                       WHEN columnType='I8' THEN 'BIGINT'                                                                                         |                                       WHEN columnType='AT' THEN 'TIME('|| TRIM(DecimalFractionalDigits)||')'                                 |
|                                       WHEN columnType='D' THEN 'DECIMAL('||TRIM(DecimalTotalDigits)||','||TRIM(DecimalFractionalDigits)||')'                     |                                       WHEN columnType='I' THEN 'INTEGER'                                                                     |
|                                       ELSE 'Unknown'                                                                                                             |                                       WHEN columnType='I1' THEN 'BYTEINT'                                                                    |
|                                   END||CASE WHEN Nullable='Y'                                                                                                    |                                       WHEN columnType='I2' THEN 'SMALLINT'                                                                   |
|    THEN'' ELSE' NOT NULL' END||'0A'XC AS V_ColT - ,B.ColumnName AS V_PICol -- Obtain the primary index of the target table                                       |                                       WHEN columnType='I8' THEN 'BIGINT'                                                                     |
|     FROM dbc.columnsV A LEFT JOIN dbc.IndicesV B                                                                                                                 |                                       WHEN columnType='D' THEN 'DECIMAL('||TRIM(DecimalTotalDigits)||','||TRIM(DecimalFractionalDigits)||')' |
|       ON A.columnName = B.columnName AND B.IndexType IN ('Q','P')                                                                                                |                                       ELSE 'Unknown'                                                                                         |
|      AND B.DatabaseName = '${V_TDDLDB}'  AND B.tablename='${TARGET_TABLE}'                                                                                       |                                   END||CASE WHEN Nullable='Y'                                                                                |
|    WHERE A.databasename='${V_TDDLDB}' AND A.tablename = '${TARGET_TABLE}'                                                                                        |             THEN '' ELSE ' NOT NULL' END||E'\x0A', ',')                  , STRING_AGG(B.ColumnName, ',')                                     |
|      AND A.columnname NOT IN ( 'ETL_JOB_NAME'                                                                                                     ,'ETL_TX_DATE' |    INTO lv_mig_V_COLS, lv_mig_V_ColT, lv_mig_V_PICol                                                                                         |
|                                ,'ETL_PROC_DATE'                                                                                                                  |    FROM mig_td_ext.vw_td_dbc_columnsV A LEFT JOIN mig_td_ext.vw_td_dbc_IndicesV B                                                            |
|                                )                                                                                                                                 |       ON A.columnName = B.columnName AND B.IndexType IN ('Q','P')                                                                            |
|     ORDER BY A.columnid;                                                                                                                                         |      AND B.DatabaseName = 'public'  AND B.tablename='emp2'                                                                                   |
|                                                                                                                                                                  |    WHERE A.databasename='public' AND A.tablename = 'emp2';                                                                                   |
|                                                                                                                                                                  |    -- ORDER BY A.columnid;                                                                                                                   |
|                                                                                                                                                                  |    END;                                                                                                                                      |
|                                                                                                                                                                  |    /                                                                                                                                         |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------+
